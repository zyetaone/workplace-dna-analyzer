import{s as g,aC as A,t as i,G as D,aD as S,g as n,i as a,aE as f,q as x,x as c,j as v,o as p}from"./oQ9KHoCl.js";import{b as w,l as u,r as C}from"./B_OUDf4Y.js";import{g as M}from"./DOOTOoZu.js";class R extends Map{#t=new Map;#e=g(0);#s=g(0);#i=A||-1;constructor(e){if(super(),e=new Map(e),i(this.#e,"SvelteMap version"),i(this.#s,"SvelteMap.size"),e){for(var[s,t]of e)super.set(s,t);this.#s.v=super.size}}#r(e){return A===this.#i?g(e):D(e)}has(e){var s=this.#t,t=s.get(e);if(t===void 0){var r=super.get(e);if(r!==void 0)t=this.#r(0),i(t,`SvelteMap get(${S(e)})`),s.set(e,t);else return n(this.#e),!1}return n(t),!0}forEach(e,s){this.#n(),super.forEach(e,s)}get(e){var s=this.#t,t=s.get(e);if(t===void 0){var r=super.get(e);if(r!==void 0)t=this.#r(0),i(t,`SvelteMap get(${S(e)})`),s.set(e,t);else{n(this.#e);return}}return n(t),super.get(e)}set(e,s){var t=this.#t,r=t.get(e),l=super.get(e),o=super.set(e,s),d=this.#e;if(r===void 0)r=this.#r(0),i(r,`SvelteMap get(${S(e)})`),t.set(e,r),a(this.#s,super.size),f(d);else if(l!==s){f(r);var h=d.reactions===null?null:new Set(d.reactions),y=h===null||!r.reactions?.every(b=>h.has(b));y&&f(d)}return o}delete(e){var s=this.#t,t=s.get(e),r=super.delete(e);return t!==void 0&&(s.delete(e),a(this.#s,super.size),a(t,-1),f(this.#e)),r}clear(){if(super.size!==0){super.clear();var e=this.#t;a(this.#s,0);for(var s of e.values())a(s,-1);f(this.#e),e.clear()}}#n(){n(this.#e);var e=this.#t;if(this.#s.v!==e.size){for(var s of super.keys())if(!e.has(s)){var t=this.#r(0);i(t,`SvelteMap get(${S(s)})`),e.set(s,t)}}for([,t]of this.#t)n(t)}keys(){return n(this.#e),super.keys()}values(){return this.#n(),super.values()}entries(){return this.#n(),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return n(this.#s),super.size}}class T{sessionsData=new R;#t=i(g(null),"SessionStore.currentSessionId");get currentSessionId(){return n(this.#t)}set currentSessionId(e){a(this.#t,e,!0)}#e=i(g(x(new Set)),"SessionStore.loading");get loading(){return n(this.#e)}set loading(e){a(this.#e,e,!0)}#s=i(g(x(new Map)),"SessionStore.errors");get errors(){return n(this.#s)}set errors(e){a(this.#s,e,!0)}#i=i(c(()=>{if(console.log(...u("log","[SessionStore] Computing currentSession, sessionId:",this.currentSessionId)),!this.currentSessionId)return null;const e=this.sessionsData.get(this.currentSessionId);return console.log("[SessionStore] Found session data:",e?"yes":"no"),e?.session||null}),"SessionStore.currentSession");get currentSession(){return n(this.#i)}set currentSession(e){a(this.#i,e)}#r=i(c(()=>{if(console.log(...u("log","[SessionStore] Computing currentAttendees, sessionId:",this.currentSessionId)),!this.currentSessionId)return[];const e=this.sessionsData.get(this.currentSessionId);return console.log(...u("log","[SessionStore] Found attendees:",e?.attendees?.length||0)),e?.attendees||[]}),"SessionStore.currentAttendees");get currentAttendees(){return n(this.#r)}set currentAttendees(e){a(this.#r,e)}#n=i(c(()=>this.currentAttendees.filter(e=>!e.completed)),"SessionStore.activeAttendees");get activeAttendees(){return n(this.#n)}set activeAttendees(e){a(this.#n,e)}#o=i(c(()=>this.currentAttendees.filter(e=>e.completed)),"SessionStore.completedAttendees");get completedAttendees(){return n(this.#o)}set completedAttendees(e){a(this.#o,e)}#a=i(c(()=>{const e=this.currentAttendees.length,s=this.completedAttendees.length;return e>0?Math.round(s/e*100):0}),"SessionStore.responseRate");get responseRate(){return n(this.#a)}set responseRate(e){a(this.#a,e)}async loadSession(e){const s=new Set(this.loading);s.add(e),this.loading=s;try{const t=(await v(w(e)))();console.log(...u("log","[SessionStore] Loaded session data:",{sessionId:e,attendeeCount:t.attendees?.length||0,attendees:t.attendees})),this.sessionsData.set(e,{session:t,attendees:t.attendees||[],lastUpdated:new Date});const r=new Map(this.errors);r.delete(e),this.errors=r}catch(t){console.error(...u("error","Failed to load session:",t));const r=new Map(this.errors);r.set(e,t),this.errors=r}finally{const t=new Set(this.loading);t.delete(e),this.loading=t}}async refreshSession(e){try{const s=(await v(C(e)))();s&&(console.log(...u("log","[SessionStore] Refreshed session data:",{sessionId:e,attendeeCount:s.attendees?.length||0,completed:s.attendees?.filter(t=>t.completed).length||0})),this.sessionsData.set(e,{session:s,attendees:s.attendees||[],lastUpdated:new Date}))}catch(s){console.error(...u("error","Failed to refresh session:",s))}}setCurrentSession(e){this.currentSessionId=e,e&&!this.sessionsData.has(e)&&this.loadSession(e)}initializeSession(e,s,t){console.log(...u("log","[SessionStore] Initializing session with data:",{sessionId:e,attendeeCount:t?.length||0})),this.sessionsData.set(e,{session:s,attendees:t||[],lastUpdated:new Date}),this.currentSessionId||(this.currentSessionId=e)}optimisticAttendeeUpdate(e,s,t){const r=this.sessionsData.get(e);if(!r)return;const l=r.attendees.findIndex(o=>p(o.id,s));if(l>=0){const o=[...r.attendees];o[l]={...o[l],...t},this.sessionsData.set(e,{...r,attendees:o,lastUpdated:new Date})}}addAttendee(e,s){const t=this.sessionsData.get(e);if(!t)return;const r=[...t.attendees,s];this.sessionsData.set(e,{...t,attendees:r,lastUpdated:new Date})}updateAttendeeResponse(e,s,t,r){const l=this.sessionsData.get(e);if(!l)return;const o=l.attendees.findIndex(d=>p(d.id,s));if(o>=0){const h=l.attendees[o].responses||{};h[t]=r,this.optimisticAttendeeUpdate(e,s,{responses:h})}}completeAttendee(e,s,t){this.optimisticAttendeeUpdate(e,s,{completed:!0,preferenceScores:t,completedAt:new Date().toISOString()})}isSessionLoaded(e){return this.sessionsData.has(e)}getSession(e){return this.sessionsData.get(e)}clear(){this.sessionsData.clear(),this.currentSessionId=null,this.loading.clear(),this.errors.clear()}}const m=new T;class P{#t=i(c(()=>{const e=m.currentAttendees;return console.log(...u("log","[AnalyticsStore] Derived attendees:",e.length)),e}),"AnalyticsStore.attendees");get attendees(){return n(this.#t)}set attendees(e){a(this.#t,e)}#e=i(c(()=>{const e=m.completedAttendees;return console.log(...u("log","[AnalyticsStore] Derived completed:",e.length)),e}),"AnalyticsStore.completed");get completed(){return n(this.#e)}set completed(e){a(this.#e,e)}#s=i(c(()=>{const e={"Baby Boomer":0,"Gen X":0,Millennial:0,"Gen Z":0};return this.attendees.forEach(s=>{s.generation&&(e[s.generation]=(e[s.generation]||0)+1)}),e}),"AnalyticsStore.generationDistribution");get generationDistribution(){return n(this.#s)}set generationDistribution(e){a(this.#s,e)}#i=i(c(()=>{if(console.log(...u("log","[AnalyticsStore] Computing preference scores, completed count:",this.completed.length)),p(this.completed.length,0))return{collaboration:0,formality:0,technology:0,wellness:0};const e=this.completed.reduce((r,l)=>{const o=l.preferenceScores;return console.log(...u("log","[AnalyticsStore] Processing attendee:",l.name,"scores:",o)),o&&(r.collaboration+=o.collaboration||0,r.formality+=o.formality||0,r.technology+=o.tech||o.technology||0,r.wellness+=o.wellness||0),r},{collaboration:0,formality:0,technology:0,wellness:0}),s=1/this.completed.length,t={collaboration:Math.round(e.collaboration*s),formality:Math.round(e.formality*s),technology:Math.round(e.technology*s),wellness:Math.round(e.wellness*s)};return console.log(...u("log","[AnalyticsStore] Computed preference scores:",t)),t}),"AnalyticsStore.preferenceScores");get preferenceScores(){return n(this.#i)}set preferenceScores(e){a(this.#i,e)}#r=i(c(()=>{const e={};return["Baby Boomer","Gen X","Millennial","Gen Z"].forEach(s=>{const t=this.completed.filter(r=>p(r.generation,s));if(t.length>0){const r=t.reduce((o,d)=>{const h=d.preferenceScores;return h&&(o.collaboration+=h.collaboration||0,o.formality+=h.formality||0,o.technology+=h.tech||h.technology||0,o.wellness+=h.wellness||0),o},{collaboration:0,formality:0,technology:0,wellness:0}),l=1/t.length;e[s]={collaboration:Math.round(r.collaboration*l),formality:Math.round(r.formality*l),technology:Math.round(r.technology*l),wellness:Math.round(r.wellness*l),count:t.length}}}),e}),"AnalyticsStore.generationPreferences");get generationPreferences(){return n(this.#r)}set generationPreferences(e){a(this.#r,e)}#n=i(c(()=>p(this.completed.length,0)?"":M(this.preferenceScores)),"AnalyticsStore.workplaceDNA");get workplaceDNA(){return n(this.#n)}set workplaceDNA(e){a(this.#n,e)}#o=i(c(()=>{const e=[];if(p(this.completed.length,0)||!this.workplaceDNA)return e;const{collaboration:s,formality:t,technology:r,wellness:l}=this.preferenceScores;this.workplaceDNA.split(" Â· ").forEach(d=>{e.push({text:d,size:60+Math.random()*20})}),s>=7?e.push({text:"Teamwork",size:45},{text:"Open Space",size:40},{text:"Huddle Rooms",size:35},{text:"Collaboration",size:42},{text:"Co-creation",size:38}):s>=4?e.push({text:"Balanced Teams",size:40},{text:"Flexible Work",size:35},{text:"Hybrid Meetings",size:33}):e.push({text:"Focus Zones",size:40},{text:"Private Offices",size:35},{text:"Deep Work",size:38},{text:"Individual Space",size:33}),t>=7?e.push({text:"Professional",size:45},{text:"Executive",size:40},{text:"Boardroom",size:35},{text:"Corporate",size:38}):t>=4?e.push({text:"Smart Casual",size:40},{text:"Adaptable",size:35},{text:"Dynamic",size:33}):e.push({text:"Relaxed",size:40},{text:"Informal",size:35},{text:"Casual Friday",size:33},{text:"Laid-back",size:30}),r>=7?e.push({text:"Smart Office",size:45},{text:"IoT",size:40},{text:"Digital Tools",size:35},{text:"Automation",size:30},{text:"AI-Powered",size:38},{text:"Cloud-First",size:33}):r>=4?e.push({text:"Hybrid Tech",size:40},{text:"Essential Digital",size:35},{text:"Practical Tools",size:30}):e.push({text:"Analog",size:40},{text:"In-Person",size:35},{text:"Face-to-Face",size:33},{text:"Traditional",size:30}),l>=7?e.push({text:"Wellbeing",size:45},{text:"Biophilic",size:40},{text:"Ergonomic",size:35},{text:"Natural Light",size:30},{text:"Mindfulness",size:33},{text:"Work-Life Balance",size:38}):l>=4?e.push({text:"Work-Life",size:40},{text:"Comfort",size:35},{text:"Healthy Options",size:30}):e.push({text:"Efficiency",size:40},{text:"Productivity",size:35},{text:"Performance",size:33},{text:"Results-Driven",size:30});const o=Object.entries(this.generationDistribution).filter(([d,h])=>h>0).sort(([,d],[,h])=>h-d)[0];if(o){const[d]=o;switch(d){case"Gen Z":e.push({text:"Sustainable",size:35},{text:"Inclusive",size:30},{text:"Purpose-Driven",size:28},{text:"Social Impact",size:25});break;case"Millennial":e.push({text:"Flexible Hours",size:35},{text:"Remote-First",size:30},{text:"Experience",size:28},{text:"Meaningful Work",size:25});break;case"Gen X":e.push({text:"Work Ethic",size:35},{text:"Results-Driven",size:30},{text:"Pragmatic",size:28},{text:"Self-Reliant",size:25});break;case"Baby Boomer":e.push({text:"Experience",size:35},{text:"Mentorship",size:30},{text:"Leadership",size:28},{text:"Dedication",size:25});break}}return e.push({text:"Innovation",size:25},{text:"Culture",size:25},{text:"Growth",size:20},{text:"Community",size:20},{text:"Agile",size:18},{text:"Future of Work",size:22}),e}),"AnalyticsStore.wordCloudData");get wordCloudData(){return n(this.#o)}set wordCloudData(e){a(this.#o,e)}#a=i(c(()=>m.activeAttendees.length),"AnalyticsStore.activeCount");get activeCount(){return n(this.#a)}set activeCount(e){a(this.#a,e)}#l=i(c(()=>this.completed.length),"AnalyticsStore.completedCount");get completedCount(){return n(this.#l)}set completedCount(e){a(this.#l,e)}#c=i(c(()=>m.responseRate),"AnalyticsStore.responseRate");get responseRate(){return n(this.#c)}set responseRate(e){a(this.#c,e)}#d=i(c(()=>{const e=Object.keys(this.generationDistribution),s=e.map(t=>this.generationDistribution[t]);return{labels:e,datasets:[{label:"Participants",data:s,backgroundColor:["rgba(255, 99, 132, 0.8)","rgba(54, 162, 235, 0.8)","rgba(255, 206, 86, 0.8)","rgba(75, 192, 192, 0.8)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)"],borderWidth:2}]}}),"AnalyticsStore.generationChartData");get generationChartData(){return n(this.#d)}set generationChartData(e){a(this.#d,e)}#h=i(c(()=>{const{collaboration:e,formality:s,technology:t,wellness:r}=this.preferenceScores;return{labels:["Collaboration","Formality","Technology","Wellness"],datasets:[{label:"Average Score",data:[e,s,t,r],backgroundColor:"rgba(75, 192, 192, 0.8)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:2,borderRadius:5,barThickness:40}]}}),"AnalyticsStore.preferenceChartData");get preferenceChartData(){return n(this.#h)}set preferenceChartData(e){a(this.#h,e)}#u=i(g(x(new Date)),"AnalyticsStore.lastUpdateTime");get lastUpdateTime(){return n(this.#u)}set lastUpdateTime(e){a(this.#u,e,!0)}#g=i(c(()=>{const e=Date.now(),s=this.lastUpdateTime.getTime(),t=e-s;return t<5e3?"Very Active":t<3e4?"Active":t<6e4?"Recent":"Idle"}),"AnalyticsStore.recentActivity");get recentActivity(){return n(this.#g)}set recentActivity(e){a(this.#g,e)}recordActivity(){this.lastUpdateTime=new Date}}const I=new P;export{I as a,m as s};
